import {useState} from 'react'
export const observe = (state)=>{
    const reflashQueue = [];
    const stateProxy = new Proxy(state,{
        set(target,key,value){
            state[key] = value;
            const length = reflashQueue.length
            for(let i=0;i<length;i++){
                const [r,reflash] = reflashQueue.shift();
                reflash(r+1);
            }
            return true;
        }
    })
    return ()=>{
        reflashQueue.push(useState(0))
        return stateProxy
    }
}
